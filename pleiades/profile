#!/bin/bash
# These commands are executed on a login or start of a PBS job.

# First, run the NAS standard setup.

if [ -e /usr/local/lib/init/global.profile ]; then
    . /usr/local/lib/init/global.profile
fi

# Add your commands here to extend your PATH, etc.

module purge
module load comp-intel/2020.4.304
module load mpi-hpe/mpt
module load szip/2.1.1
module load pkgsrc/2021Q2
module load python3/3.9.5

# Increase MPI_TYPE_DEPTH from 14 to 24 (seems to be needed by HDF5
# when used with SGI MPT 2.12).
export MPI_TYPE_DEPTH=24

add_lib_path () {
    export LD_LIBRARY_PATH=$1:$LD_LIBRARY_PATH
}

add_lib_path ${LOCAL_LIB_DIR}/lib
add_lib_path ${LOCAL_LIB_DIR}/hdf5/lib
add_lib_path ${LOCAL_LIB_DIR}/netcdf/lib

export PISM_MPIDO='mpiexec -n'
